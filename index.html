<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <!-- Đặt viewport cố định để hiển thị giao diện PC trên mọi thiết bị -->
    <meta name="viewport" content="width=1024">
    <!-- Meta tags tối ưu hiệu suất -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <meta http-equiv="Cache-Control" content="max-age=31536000, immutable">
    <meta name="description" content="Tự xây dựng cấu hình PC với công cụ TRUONG PHAT COMPUTER - Chọn linh kiện máy tính phù hợp nhu cầu và ngân sách">
    
    <title>BUILD PC TRUONG PHAT COMPUTER - Chọn Linh Kiện Máy Tính</title>
    
    <!-- DNS Prefetch và Preconnect -->
    <link rel="dns-prefetch" href="https://cdn.sheetjs.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://unpkg.com">
    
    <link rel="preconnect" href="https://cdn.sheetjs.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    
    <!-- Preload CSS quan trọng -->
    <link rel="preload" href="./buildsan.css" as="style">
    <link rel="preload" href="./styles.css" as="style">
    
    <!-- Thư viện XLSX - Nhất định phải tải trước các script khác -->
    <script src="https://cdn.sheetjs.com/xlsx-0.18.9/package/dist/xlsx.full.min.js" defer></script>
    
    <!-- CSS chính -->
    <link rel="stylesheet" href="./buildsan.css">
    <link rel="stylesheet" href="./styles.css">
    
    <!-- Fix CSS để giải quyết vấn đề giao diện -->
    <link rel="stylesheet" href="./fix-styles.css">
    
    <!-- Chỉ load font awesome icons cần thiết thay vì toàn bộ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    
    <!-- Progressive Web App -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#222831">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="/images/icon-192.png">
    
    <!-- CSS cho modal/popup -->
    <link rel="stylesheet" href="./modal-styles.css" media="print" onload="this.media='all'">
    
    <!-- Animation library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload="this.media='all'">
    
    <!-- Fix CSS Layout -->
    <style>
        /* Reset header styling to match first image */
        header {
            background: linear-gradient(135deg, #0053b4, #0275d8);
            padding: 15px 0;
        }
        
        /* Logo styling */
        header .logo {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
        }
        
        /* Fix main container layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Fix navigation items */
        .nav-items {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .nav-item {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 80px;
            height: 80px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        
        .nav-item.active {
            background-color: #007bff;
            color: white;
        }
        
        /* Fix budget range slider */
        .budget-section {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* CPU selection styling */
        .cpu-selection {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .cpu-options {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        
        .cpu-option {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        
        .cpu-option.selected {
            border-color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
        }
        
        /* Game selection styling */
        .game-selection {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .game-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        /* Fix dark mode toggle */
        .dark-mode-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        /* Ensure main game cards look correct */
        .game-card {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            height: 150px;
        }
        
        .game-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .game-title {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 5px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        /* Fix button styling */
        .btn-configure {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            margin: 20px auto;
            display: block;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-configure:hover {
            background-color: #0069d9;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* Fix header contact buttons */
        .contact-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }
        
        /* Apply the card-style for component sections */
        section {
            background-color: white;
            border-radius: 10px;
            margin-bottom: 20px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h2 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            font-size: 1.3rem;
        }
        
        h2 i {
            margin-right: 10px;
            color: #007bff;
        }
    </style>
    
    <script>
        // Fix for "exports is not defined" errors
        if (typeof exports === 'undefined') {
            window.exports = {};
            window.module = { exports: window.exports };
        }
        
        // Fix for 'require is not defined' error
        if (typeof require === 'undefined') {
            window.require = function(module) {
                console.log('Mock require called for:', module);
                return {};
            };
        }
        
        // Fix for "process is not defined" error
        if (typeof process === 'undefined') {
            window.process = {
                env: { NODE_ENV: 'production' },
                browser: true,
                versions: { node: false }
            };
        }
        
        // Fix for potential infinite recursion in getWindow/getComputedStyle
        const originalGetComputedStyle = window.getComputedStyle;
        const computedStyleCache = new WeakMap();
        
        window.getComputedStyle = function(element, pseudoElt) {
            if (!element) return null;
            
            // Return cached result if available
            if (computedStyleCache.has(element)) {
                return computedStyleCache.get(element);
            }
            
            try {
                // Handle special element types that might cause recursion
                if (element instanceof HTMLCanvasElement || 
                    element instanceof HTMLImageElement ||
                    element instanceof SVGElement ||
                    element instanceof HTMLScriptElement) {
                    const defaultStyle = {
                        getPropertyValue: () => '',
                        setProperty: () => {},
                    };
                    computedStyleCache.set(element, defaultStyle);
                    return defaultStyle;
                }
                
                const result = originalGetComputedStyle.call(window, element, pseudoElt);
                computedStyleCache.set(element, result);
                return result;
            } catch (e) {
                console.warn('Error in getComputedStyle:', e);
                return originalGetComputedStyle.call(window, document.body); // Fallback
            }
        };
        
        // Fix for read-only window properties
        const windowProxy = new Proxy(window, {
            set(target, prop, value) {
                if (['top', 'parent', 'self', 'window', 'frames', 'location'].includes(prop)) {
                    const safeProp = `${prop}_safe`;
                    try {
                        Object.defineProperty(target, safeProp, {
                            value,
                            writable: true,
                            configurable: true
                        });
                        console.log(`Created safe property '${safeProp}' for read-only '${prop}'`);
                        return true;
                    } catch (e) {
                        console.warn(`Could not create safe property for ${prop}:`, e);
                        return true; // Prevent error
                    }
                }
                target[prop] = value;
                return true;
            }
        });
        
        // Apply the proxy
        try {
            if (typeof globalThis !== 'undefined') {
                globalThis.windowProxy = windowProxy;
            }
        } catch (e) {
            console.warn('Failed to create window proxy:', e);
        }
        
        // Lazy load images
        document.addEventListener("DOMContentLoaded", function() {
            const lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));
            
            if ("IntersectionObserver" in window) {
                let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
                    entries.forEach(function(entry) {
                        if (entry.isIntersecting) {
                            let lazyImage = entry.target;
                            lazyImage.src = lazyImage.dataset.src;
                            if (lazyImage.dataset.srcset) {
                                lazyImage.srcset = lazyImage.dataset.srcset;
                            }
                            lazyImage.classList.remove("lazy");
                            lazyImageObserver.unobserve(lazyImage);
                        }
                    });
                });
                
                lazyImages.forEach(function(lazyImage) {
                    lazyImageObserver.observe(lazyImage);
                });
            } else {
                // Fallback for browsers without IntersectionObserver
                let active = false;
                
                const lazyLoad = function() {
                    if (active === false) {
                        active = true;
                        
                        setTimeout(function() {
                            lazyImages.forEach(function(lazyImage) {
                                if ((lazyImage.getBoundingClientRect().top <= window.innerHeight && lazyImage.getBoundingClientRect().bottom >= 0) && getComputedStyle(lazyImage).display !== "none") {
                                    lazyImage.src = lazyImage.dataset.src;
                                    if (lazyImage.dataset.srcset) {
                                        lazyImage.srcset = lazyImage.dataset.srcset;
                                    }
                                    lazyImage.classList.remove("lazy");
                                    
                                    lazyImages = lazyImages.filter(function(image) {
                                        return image !== lazyImage;
                                    });
                                    
                                    if (lazyImages.length === 0) {
                                        document.removeEventListener("scroll", lazyLoad);
                                        window.removeEventListener("resize", lazyLoad);
                                        window.removeEventListener("orientationchange", lazyLoad);
                                    }
                                }
                            });
                            
                            active = false;
                        }, 200);
                    }
                };
                
                document.addEventListener("scroll", lazyLoad);
                window.addEventListener("resize", lazyLoad);
                window.addEventListener("orientationchange", lazyLoad);
                lazyLoad();
            }
        });
        
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/service-worker.js');
            });
        }
    </script>
    <script src="./enums.js" defer></script>
</head>

<body>
    <header>
        <div class="logo-container">
            <div class="logo">
                <i class="fas fa-desktop fa-spin"></i>
                <span>TRUONG PHAT COMPUTER</span>
            </div>
            <button id="dark-mode-toggle" title="Chuyển chế độ sáng/tối" style="margin-left:20px;font-size:1.5em;background:none;border:none;cursor:pointer;color:#fff;"><i class="fas fa-moon"></i></button>
        </div>
        <div class="contact-buttons">
            <a href="https://zalo.me/0836768597" target="_blank" class="contact-button">
                <i class="fab fa-zalo"></i> Liên hệ qua Zalo
            </a>
            <div class="phone-number">
                <a href="tel:0836768597">
                    <i class="fas fa-phone-alt"></i>
                    <span>0836768597</span>
                </a>
            </div>
            <a href="https://www.facebook.com/tpcom.hb" target="_blank" class="contact-button">
                <i class="fab fa-facebook"></i> Liên hệ qua Facebook
            </a>
        </div>
    </header>

    <div class="main-container">
        <div class="page-title">
            <h1><i class="fas fa-tools"></i> XÂY DỰNG CẤU HÌNH PC <i class="fas fa-tools"></i></h1>
            <p class="subtitle">Tùy chỉnh theo nhu cầu và ngân sách của bạn</p>
        </div>

        <div class="container">
            <div class="build-progress">
                <div class="progress-step active" data-step="1">
                    <div class="step-icon"><i class="fas fa-money-bill-wave"></i></div>
                    <div class="step-label">Ngân sách</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-icon"><i class="fas fa-microchip"></i></div>
                    <div class="step-label">CPU</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-icon"><i class="fas fa-gamepad"></i></div>
                    <div class="step-label">Game</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-icon"><i class="fas fa-laptop-code"></i></div>
                    <div class="step-label">Linh kiện</div>
                </div>
                <div class="progress-step" data-step="5">
                    <div class="step-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="step-label">Hoàn thành</div>
                </div>
            </div>

            <!-- Phần tầm tiền -->
            <section id="budget-range-selection" class="selection-section accent-section">
                <div class="section-header">
                    <i class="fas fa-money-bill-wave"></i>
                    <h2>Chọn Cấu Hình Tầm Tiền Mong Muốn</h2>
                </div>
                <div class="slider-container">
                    <div class="slider-value-container">
                        <span id="budget-value-min">3 triệu</span>
                        <span id="budget-value" class="budget-value-current">3 triệu</span>
                        <span id="budget-value-max">30 triệu</span>
                    </div>
                    <input type="range" id="budget-range" min="3000000" max="30000000" step="1000000" value="3000000" class="slider">
                    <div class="slider-ticks">
                        <span>3M</span>
                        <span>10M</span>
                        <span>20M</span>
                        <span>30M</span>
                    </div>
                </div>
            </section>

            <!-- Phần chọn loại CPU -->
            <section id="cpu-type-selection" class="selection-section accent-section">
                <div class="section-header">
                    <i class="fas fa-microchip"></i>
                    <h2>Chọn Loại CPU</h2>
                </div>
                <div class="cpu-brand-selection">
                    <div class="brand-option" id="intel-option" onclick="handleCpuSelection('Intel')">
                        <div class="brand-logo">
                            <img src="images/intel.jpg" alt="Intel Logo" style="height:48px;width:auto;object-fit:contain;" onerror="this.style.display='none';this.parentNode.innerHTML='<i class=\'fab fa-intel\'></i>'">
                        </div>
                        <div class="brand-name">INTEL</div>
                    </div>
                    <div class="brand-option" id="amd-option" onclick="handleCpuSelection('Amd')">
                        <div class="brand-logo">
                            <img src="images/amd.jpg" alt="AMD Logo" style="height:48px;width:auto;object-fit:contain;" onerror="this.style.display='none';this.parentNode.innerHTML='<i class=\'fab fa-amd\'></i>'">
                        </div>
                        <div class="brand-name">AMD</div>
                    </div>
                </div>
                <select id="cpu-type" name="cpu-type" class="dropdown hidden-dropdown" required>
                    <option value="Intel">INTEL</option>
                    <option value="Amd">AMD</option>
                </select>
            </section>

            <!-- Inline script để đảm bảo sự kiện click luôn hoạt động -->
            <script>
                function handleCpuSelection(type) {
                    console.log('Direct CPU selection click:', type);
                    
                    // Update visual UI immediately
                    const intelOption = document.getElementById('intel-option');
                    const amdOption = document.getElementById('amd-option');
                    const cpuTypeDropdown = document.getElementById('cpu-type');
                    
                    if (type === 'Intel') {
                        intelOption.classList.add('selected');
                        amdOption.classList.remove('selected');
                        if (cpuTypeDropdown) cpuTypeDropdown.value = 'Intel';
                    } else {
                        amdOption.classList.add('selected');
                        intelOption.classList.remove('selected');
                        if (cpuTypeDropdown) cpuTypeDropdown.value = 'Amd';
                    }
                    
                    // Trigger CPU-type change event
                    if (cpuTypeDropdown) {
                        cpuTypeDropdown.dispatchEvent(new Event('change'));
                    }
                    
                    // Use a small timeout to ensure event-handlers.js has loaded
                    setTimeout(() => {
                        // Call the global handler function if available
                        if (typeof window.handleCpuTypeSelection === 'function') {
                            console.log('Calling global handleCpuTypeSelection with:', type);
                            window.handleCpuTypeSelection(type);
                        } else {
                            console.warn('Global handleCpuTypeSelection function not found! Using fallback...');
                            
                            // Fallback: Apply basic UI changes
                            document.body.setAttribute('data-selected-cpu-type', type);
                            document.body.setAttribute('data-current-cpu-type', type);
                            
                            // Create permanent indicator
                            const existingIndicator = document.getElementById('permanent-cpu-indicator');
                            if (existingIndicator) existingIndicator.remove();
                            
                            const cpuIndicator = document.createElement('div');
                            cpuIndicator.style.position = 'fixed';
                            cpuIndicator.style.bottom = '20px';
                            cpuIndicator.style.right = '20px';
                            cpuIndicator.style.padding = '15px 20px';
                            cpuIndicator.style.backgroundColor = type === 'Intel' ? '#0071c5' : '#ED1C24';
                            cpuIndicator.style.color = 'white';
                            cpuIndicator.style.fontWeight = 'bold';
                            cpuIndicator.style.fontSize = '18px';
                            cpuIndicator.style.zIndex = '10000';
                            cpuIndicator.style.borderRadius = '5px';
                            cpuIndicator.style.boxShadow = '0 0 15px rgba(0,0,0,0.5)';
                            cpuIndicator.id = 'permanent-cpu-indicator';
                            cpuIndicator.textContent = `${type.toUpperCase()} MODE`;
                            document.body.appendChild(cpuIndicator);
                            
                            // Try to reload config with selected CPU
                            try {
                                const gameId = document.getElementById('game-genre')?.value;
                                const budget = parseInt(document.getElementById('budget-range')?.value);
                                if (typeof window.autoSelectConfig === 'function' && gameId && budget) {
                                    window.autoSelectConfig(gameId, budget, type);
                                }
                            } catch (e) {
                                console.error('Error in fallback config selection:', e);
                            }
                        }
                    }, 100);
                }
                
                // Thêm CSS động để làm nổi bật nút được chọn
                const style = document.createElement('style');
                style.textContent = `
                    .brand-option {
                        cursor: pointer !important;
                        transition: all 0.3s ease;
                        border: 3px solid transparent;
                        position: relative;
                        z-index: 5;
                    }
                    .brand-option:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    }
                    .brand-option.selected {
                        border-color: #4CAF50;
                        box-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
                    }
                    #intel-option.selected {
                        border-color: #0071c5;
                        box-shadow: 0 0 15px rgba(0, 113, 197, 0.5);
                    }
                    #amd-option.selected {
                        border-color: #ED1C24;
                        box-shadow: 0 0 15px rgba(237, 28, 36, 0.5);
                    }
                    .brand-option::after {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        z-index: 10;
                    }
                `;
                document.head.appendChild(style);
                
                // Handle direct clicks with redundant event listeners
                document.addEventListener('DOMContentLoaded', function() {
                    // Add redundant click handlers to ensure clicks work
                    document.querySelectorAll('#intel-option, #amd-option').forEach(el => {
                        el.addEventListener('click', function(e) {
                            const type = this.id === 'intel-option' ? 'Intel' : 'Amd';
                            console.log(`Extra click handler for ${type} activated`);
                            handleCpuSelection(type);
                            e.preventDefault();
                            e.stopPropagation();
                        });
                    });
                    
                    // Set a hard-coded click handler on document
                    document.addEventListener('click', function(e) {
                        const intelOption = document.getElementById('intel-option');
                        const amdOption = document.getElementById('amd-option');
                        
                        if (e.target && (e.target === intelOption || intelOption.contains(e.target))) {
                            console.log('Document-level Intel click detected');
                            handleCpuSelection('Intel');
                        } else if (e.target && (e.target === amdOption || amdOption.contains(e.target))) {
                            console.log('Document-level AMD click detected');
                            handleCpuSelection('Amd');
                        }
                    });
                });
            </script>

            <!-- Phần chọn game -->
            <section id="game-selection" class="selection-section accent-section">
                <div class="section-header">
                    <i class="fas fa-gamepad"></i>
                    <h2>Chọn Game Muốn Chơi</h2>
                </div>
                <div class="game-grid">
                    <div class="game-card" data-game="valorant">
                        <div class="game-image" style="background-image: url('images/valorant.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Valorant</div>
                    </div>
                    <div class="game-card" data-game="csgo">
                        <div class="game-image" style="background-image: url('images/csgo.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">CS:GO</div>
                    </div>
                    <div class="game-card" data-game="pubg">
                        <div class="game-image" style="background-image: url('images/pubg.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">PUBG</div>
                    </div>
                    <div class="game-card" data-game="lol">
                        <div class="game-image" style="background-image: url('images/lol.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Liên Minh Huyền Thoại</div>
                    </div>
                    <div class="game-card" data-game="gta-v">
                        <div class="game-image" style="background-image: url('images/gta-v.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">GTA V</div>
                    </div>
                    <div class="game-card" data-game="elden-ring">
                        <div class="game-image" style="background-image: url('images/elden-ring.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Elden Ring</div>
                    </div>
                    <div class="game-card" data-game="naraka">
                        <div class="game-image" style="background-image: url('images/naraka.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Naraka: Bladepoint</div>
                    </div>
                    <div class="game-card" data-game="genshin">
                        <div class="game-image" style="background-image: url('images/genshin.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Genshin Impact</div>
                    </div>
                    <div class="game-card" data-game="fo4">
                        <div class="game-image" style="background-image: url('images/fo4.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">FIFA Online 4</div>
                    </div>
                    <div class="game-card" data-game="black-myth-wukong">
                        <div class="game-image" style="background-image: url('images/black-myth-wukong.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Black Myth: Wukong</div>
                    </div>
                    <div class="game-card" data-game="god-of-war">
                        <div class="game-image" style="background-image: url('images/god-of-war.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">God of War</div>
                    </div>
                    <div class="game-card" data-game="battle-teams-2">
                        <div class="game-image" style="background-image: url('images/battle-teams-2.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Battle Teams 2</div>
                    </div>
                    <div class="game-card" data-game="delta-force">
                        <div class="game-image" style="background-image: url('images/delta-force.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Delta Force</div>
                    </div>
                    <div class="game-card" data-game="audition">
                        <div class="game-image" style="background-image: url('images/audition.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">Audition</div>
                    </div>
                    <div class="game-card" data-game="mu-origin">
                        <div class="game-image" style="background-image: url('images/mu-origin.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">MU Origin</div>
                    </div>
                    <div class="game-card" data-game="crossfire">
                        <div class="game-image" style="background-image: url('images/crossfire.jpg'); background-size: cover; background-position: center; height: 100px;"></div>
                        <div class="game-name">CrossFire</div>
                    </div>
                </div>
                <select id="game-genre" name="game-genre" class="dropdown hidden-dropdown" required>
                    <option value="">Chọn game</option>
                    <option value="valorant">Valorant</option>
                    <option value="csgo">CS:GO</option>
                    <option value="pubg">PUBG</option>
                    <option value="lol">Liên Minh Huyền Thoại (LOL)</option>
                    <option value="gta-v">GTA V</option>
                    <option value="elden-ring">Elden Ring</option>
                    <option value="naraka">Naraka: Bladepoint</option>
                    <option value="genshin">Genshin Impact</option>
                    <option value="fo4">FIFA Online 4</option>
                    <option value="black-myth-wukong">Black Myth: Wukong</option>
                    <option value="god-of-war">God of War</option>
                    <option value="battle-teams-2">Battle Teams 2</option>
                    <option value="delta-force">Delta Force</option>
                    <option value="audition">Audition</option>
                    <option value="mu-origin">MU Origin</option>
                    <option value="crossfire">CrossFire</option>
                </select>
                
                <div class="auto-select-container" style="margin-top: 20px; text-align: center;">
                    <button id="manual-auto-select" class="action-button primary-btn" style="display: inline-block; padding: 10px 20px;">
                        <i class="fas fa-magic"></i> Tự Động Chọn Cấu Hình
                    </button>
                </div>
            </section>

            <section id="component-selection" class="selection-section">
                <div class="section-header">
                    <i class="fas fa-laptop-code"></i>
                    <h2>Lựa Chọn Linh Kiện Chính</h2>
                </div>
                <div class="container">
                    <div id="socket-message" class="warning-message" style="display: none; margin: 10px 0; padding: 10px; background-color: #fff3cd; border-radius: 5px; color: #856404;"></div>
                    <div class="components-grid">
                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-microchip"></i>
                                <h3>CPU</h3>
                                <div class="compatibility-icon" id="cpu-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="cpu" name="cpu" class="dropdown">
                                <option value="" disabled selected>Chọn CPU</option>
                            </select>
                            <div class="component-info-hover" id="cpu-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-server"></i>
                                <h3>Mainboard</h3>
                                <div class="compatibility-icon" id="mainboard-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="mainboard" name="mainboard" class="dropdown">
                                <option value="" disabled selected>Chọn Mainboard</option>
                            </select>
                            <div class="component-info-hover" id="mainboard-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-tv"></i>
                                <h3>Card Đồ Họa (VGA)</h3>
                                <div class="compatibility-icon" id="vga-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="vga" name="vga" class="dropdown">
                                <option value="" disabled selected>Chọn VGA</option>
                            </select>
                            <div class="component-info-hover" id="vga-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-memory"></i>
                                <h3>RAM</h3>
                                <div class="compatibility-icon" id="ram-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="ram" name="ram" class="dropdown">
                                <option value="" disabled selected>Chọn RAM</option>
                            </select>
                            <div class="component-info-hover" id="ram-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-hdd"></i>
                                <h3>Ổ Cứng SSD</h3>
                                <div class="compatibility-icon" id="ssd-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="ssd" name="ssd" class="dropdown">
                                <option value="" disabled selected>Chọn SSD</option>
                            </select>
                            <div class="component-info-hover" id="ssd-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-bolt"></i>
                                <h3>Nguồn (PSU)</h3>
                                <div class="compatibility-icon" id="psu-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="psu" name="psu" class="dropdown">
                                <option value="" disabled selected>Chọn PSU</option>
                            </select>
                            <div class="component-info-hover" id="psu-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-cube"></i>
                                <h3>Vỏ Case</h3>
                                <div class="compatibility-icon" id="case-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="case" name="case" class="dropdown">
                                <option value="" disabled selected>Chọn Case</option>
                            </select>
                            <div class="component-info-hover" id="case-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-wind"></i>
                                <h3>Tản Nhiệt CPU</h3>
                                <div class="compatibility-icon" id="cpuCooler-compatibility"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <select id="cpuCooler" name="cpuCooler" class="dropdown">
                                <option value="" disabled selected>Chọn Tản Nhiệt CPU</option>
                            </select>
                            <div class="component-info-hover" id="cpuCooler-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="additional-selection" class="selection-section">
                <div class="section-header">
                    <i class="fas fa-plus-circle"></i>
                    <h2>Lựa Chọn Thêm (Tùy Chọn)</h2>
                </div>
                <div class="container">
                    <div class="components-grid">
                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-database"></i>
                                <h3>HDD</h3>
                            </div>
                            <select id="hdd" name="hdd" class="dropdown">
                                <option value="" disabled selected>Chọn HDD</option>
                            </select>
                            <div class="component-info-hover" id="hdd-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>

                        <div class="component">
                            <div class="component-header">
                                <i class="fas fa-desktop"></i>
                                <h3>Màn Hình</h3>
                            </div>
                            <select id="monitor" name="monitor" class="dropdown">
                                <option value="" disabled selected>Chọn Màn Hình</option>
                            </select>
                            <div class="component-info-hover" id="monitor-info">
                                <div class="specs-preview"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="selected-components">
                <div class="section-header">
                    <i class="fas fa-list-check"></i>
                    <h2>Linh kiện đã chọn</h2>
                </div>
                <div id="selected-components-list" class="selected-components-grid"></div>
            </section>

            <div id="compatibility-alert" class="compatibility-alert hidden">
                <i class="fas fa-exclamation-triangle"></i>
                <div class="alert-message" id="compatibility-message"></div>
                <button id="close-alert" class="close-alert"><i class="fas fa-times"></i></button>
            </div>

            <div id="summary-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2><i class="fas fa-clipboard-list"></i> Cấu hình chi tiết</h2>
                        <span class="close-modal">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div id="modal-components-list"></div>
                        <div id="modal-total-price">Tổng cộng: 0 VNĐ</div>
                        <div id="image-preview-container"></div>
                        <div class="share-options">
                            <button id="share-facebook" class="share-button"><i class="fab fa-facebook"></i> Chia sẻ Facebook</button>
                            <button id="copy-link" class="share-button"><i class="fas fa-link"></i> Sao chép liên kết</button>
                            <button id="download-config" class="share-button luu-cau-hinh"><i class="fas fa-download"></i> Tải cấu hình</button>
                        </div>
                    </div>
                </div>
            </div>

            <section id="total-price" class="total-price">
                <h2>Tổng Tiền Dự Kiến</h2>
                <p>0 VNĐ</p>
                <div class="price-breakdown">
                    <button id="view-breakdown" class="view-breakdown-btn"><i class="fas fa-receipt"></i> Xem chi tiết</button>
                </div>
            </section>

            <div class="button-group">
                <button type="button" class="action-button secondary-btn" id="reset-button">
                    <i class="fas fa-redo"></i> Làm mới
                </button>
                <button type="button" class="action-button primary-btn" id="calculate-button">
                    <i class="fas fa-clipboard-check"></i> XEM CHI TIẾT VÀ ĐÁNH GIÁ
                </button>
                <button type="button" class="action-button accent-btn luu-cau-hinh" id="save-button">
                    <i class="fas fa-save"></i> Lưu cấu hình
                </button>
            </div>
            
            <!-- Bảng chi tiết cấu hình -->
            <div id="config-table" class="config-table" style="display:none; margin: 20px auto; max-width: 90%; overflow-x: auto; background-color: white; box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 8px;">
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                    <thead>
                        <tr style="background-color: #2196F3; color: white;">
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">STT</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">HÌNH ẢNH</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">TÊN, MÃ, LOẠI LINH KIỆN</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ĐVT</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">SỐ LƯỢNG</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">ĐƠN GIÁ</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">THÀNH TIỀN</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">BẢO HÀNH</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">GHI CHÚ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background-color: #f9f9f9;">
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="cpu-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="cpu-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="cpu-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="cpu-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">36T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">2</td>
                            <td id="mainboard-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="mainboard-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="mainboard-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="mainboard-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">36T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">3</td>
                            <td id="ram-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="ram-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="ram-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="ram-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">36T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">4</td>
                            <td id="vga-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="vga-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="vga-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="vga-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">3T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">5</td>
                            <td id="ssd-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="ssd-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="ssd-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="ssd-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">36T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">6</td>
                            <td id="cpu-cooler-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="cpu-cooler-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="cpu-cooler-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="cpu-cooler-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">12T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">7</td>
                            <td id="psu-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="psu-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="psu-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="psu-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">36T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">8</td>
                            <td id="case-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="case-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="case-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="case-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">12T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">9</td>
                            <td id="hdd-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="additional-component-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="additional-component-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="additional-component-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">12T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">10</td>
                            <td id="monitor-image" style="padding: 10px; text-align: center; border: 1px solid #ddd;"></td>
                            <td id="monitor-name" style="padding: 10px; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">Chiếc</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">1</td>
                            <td id="monitor-price" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td id="monitor-total" style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">36T</td>
                            <td style="padding: 10px; text-align: center; border: 1px solid #ddd;">NEW</td>
                        </tr>
                        <tr>
                            <td colspan="6" style="text-align: right; padding: 10px; border: 1px solid #ddd;"><strong>Tổng cộng</strong></td>
                            <td id="total-price-cell" style="padding: 10px; text-align: right; font-weight: bold; color: #f44336; border: 1px solid #ddd;">0</td>
                            <td colspan="2" style="border: 1px solid #ddd;"></td>
                        </tr>
                        <tr>
                            <td colspan="6" style="text-align: right; padding: 10px; border: 1px solid #ddd;"><strong>Chiết khấu</strong></td>
                            <td style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td colspan="2" style="border: 1px solid #ddd;"></td>
                        </tr>
                        <tr>
                            <td colspan="6" style="text-align: right; padding: 10px; border: 1px solid #ddd;"><strong>Đã thanh toán</strong></td>
                            <td style="padding: 10px; text-align: right; border: 1px solid #ddd;"></td>
                            <td colspan="2" style="border: 1px solid #ddd;"></td>
                        </tr>
                        <tr>
                            <td colspan="6" style="text-align: right; padding: 10px; border: 1px solid #ddd;"><strong>Còn lại</strong></td>
                            <td id="remaining-price-cell" style="padding: 10px; text-align: right; font-weight: bold; color: #f44336; border: 1px solid #ddd;">0</td>
                            <td colspan="2" style="border: 1px solid #ddd;"></td>
                        </tr>
                    </tbody>
                </table>
                <div id="socket-message" class="system-message" style="margin: 15px; padding: 10px; background-color: #e7f3fe; border: 1px solid #b6dcfe; color: #0c5460; border-radius: 5px;"></div>
                <div id="score-message" class="system-message" style="margin: 15px; padding: 10px; background-color: #d4edda; border: 1px solid #c3e6cb; color: #155724; border-radius: 5px;"></div>
                <div id="upgrade-message" class="system-message" style="margin: 15px; padding: 10px; background-color: #fff3cd; border: 1px solid #ffeeba; color: #856404; border-radius: 5px;"></div>
            </div>
        </div>
    </div>

    <!-- Modal dialog for configuration details -->
    <div class="modal">
        <div class="modal-content">
            <!-- Modal content will be dynamically inserted here -->
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-logo">
                <i class="fas fa-desktop"></i> TRUONG PHAT COMPUTER
            </div>
            <div class="footer-contact">
                <div><i class="fas fa-map-marker-alt"></i> Địa chỉ: Hòa Bình, Việt Nam</div>
                <div><i class="fas fa-phone"></i> Hotline: 0836768597</div>
                <div><i class="fas fa-envelope"></i> Email: contact@truongphatcomputer.com</div>
            </div>
            <div class="footer-social">
                <a href="https://www.facebook.com/tpcom.hb" target="_blank"><i class="fab fa-facebook"></i></a>
                <a href="#" target="_blank"><i class="fab fa-youtube"></i></a>
                <a href="#" target="_blank"><i class="fab fa-tiktok"></i></a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 BUILD PC TRUONG PHAT COMPUTER. All rights reserved.</p>
        </div>
    </footer>

    <div id="to-top-button" class="to-top-button">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Script for the interactive PC builder -->
    <script src="./components-data.js"></script>
    <script src="./buildsan.js" type="module"></script>
    <!-- Script for Excel export functionality -->
    <script src="./auto-export-config.js"></script>
    <!-- Script for enhanced auto-config functionality -->
    <script src="./auto-config-helper.js"></script>
    
    <!-- Tải trình tải dữ liệu linh kiện -->
    <script src="./import-loader.js" type="module"></script>
    
    <script>
        // Load required libraries
        function loadRequiredLibraries() {
            return new Promise((resolve, reject) => {
                // Load Popper.js
                if (typeof window.Popper === 'undefined') {
                    const popperScript = document.createElement('script');
                    popperScript.src = 'https://unpkg.com/@popperjs/core@2.11.8/dist/umd/popper.min.js';
                    popperScript.onload = () => {
                        console.log('Popper.js loaded successfully');
                        resolve();
                    };
                    popperScript.onerror = () => reject(new Error('Failed to load Popper.js'));
                    document.head.appendChild(popperScript);
                } else {
                    resolve();
                }
            });
        }

        // Hàm populateDropdowns
        function populateDropdowns() {
            console.log('Initializing dropdowns...');
            try {
                // Lấy các dropdown
                const componentDropdowns = {
                    'cpu': document.getElementById('cpu'),
                    'mainboard': document.getElementById('mainboard'),
                    'vga': document.getElementById('vga'),
                    'ram': document.getElementById('ram'),
                    'ssd': document.getElementById('ssd'),
                    'psu': document.getElementById('psu'),
                    'case': document.getElementById('case'),
                    'cpuCooler': document.getElementById('cpuCooler'),
                    'hdd': document.getElementById('hdd'),
                    'monitor': document.getElementById('monitor')
                };
                
                // Lấy dữ liệu từ window object
                const componentsData = {
                    'cpu': window.cpuData || {},
                    'mainboard': window.mainboardData || {},
                    'vga': window.vgaData || {},
                    'ram': window.ramData || {},
                    'ssd': window.ssdData || {},
                    'psu': window.psuData || {},
                    'case': window.caseData || {},
                    'cpuCooler': window.cpuCoolerData || {},
                    'hdd': window.hddData || {},
                    'monitor': window.monitorData || {}
                };
                
                // Thêm options cho mỗi dropdown từ dữ liệu tương ứng
                Object.keys(componentDropdowns).forEach(componentType => {
                    const dropdown = componentDropdowns[componentType];
                    const data = componentsData[componentType];
                    
                    if (dropdown && data && Object.keys(data).length > 0 && dropdown.options.length <= 1) {
                        // Xóa tất cả options hiện tại trừ option đầu tiên (thường là placeholder)
                        const placeholderOption = dropdown.options[0];
                        dropdown.innerHTML = '';
                        if (placeholderOption) {
                            dropdown.appendChild(placeholderOption);
                        }
                        
                        // Thêm options mới từ dữ liệu
                        Object.keys(data).forEach(key => {
                            const component = data[key];
                            const option = document.createElement('option');
                            option.value = key;
                            option.text = `${component.name} - ${formatPrice(component.price)} VNĐ`;
                            option.dataset.price = component.price;
                            option.dataset.image = component.image;
                            dropdown.appendChild(option);
                        });
                        
                        console.log(`Added ${Object.keys(data).length} options to ${componentType} dropdown`);
                    }
                });
                
                console.log('Dropdowns populated successfully');
            } catch (error) {
                console.error('Error in populateDropdowns:', error);
            }
        }
        
        // Helper function to format price
        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                await loadRequiredLibraries();
                
                // Lắng nghe sự kiện dữ liệu đã được tải
                document.addEventListener('component-data-loaded', () => {
                    console.log('Nhận được sự kiện component-data-loaded, đang điền dữ liệu vào dropdowns');
                    populateDropdowns();
                });
                
                // Make sure config table is hidden initially
                const configTable = document.getElementById('config-table');
                if (configTable) {
                    configTable.style.display = 'none';
                }
                
                // Register event listener for the calculate button
                const calculateButton = document.getElementById('calculate-button');
                if (calculateButton && configTable) {
                    calculateButton.addEventListener('click', function() {
                        // Check if any components are selected
                        const componentIds = ['cpu', 'mainboard', 'ram', 'vga', 'ssd', 'cpuCooler', 'psu', 'case', 'hdd', 'monitor'];
                        let anyComponentSelected = false;
                        
                        for (const id of componentIds) {
                            const select = document.getElementById(id);
                            if (select && select.value) {
                                anyComponentSelected = true;
                                break;
                            }
                        }
                        
                        if (anyComponentSelected) {
                            // If component-connector.js has loaded our function
                            if (typeof window.updateConfigTableImages === 'function') {
                                window.updateConfigTableImages();
                            }
                            
                            // Show the config table
                            configTable.style.display = 'block';
                            console.log('Configuration table shown with updated component data');
                        } else {
                            // No components selected
                            alert('Vui lòng chọn ít nhất một linh kiện trước khi xem chi tiết.');
                            console.log('No components selected, not showing table');
                        }
                    });
                }
                
                // Nếu sau 5 giây vẫn chưa nhận được sự kiện, thử kiểm tra dữ liệu trực tiếp
                setTimeout(() => {
                    if (window.cpuData && !document.getElementById('cpu').options.length > 1) {
                        console.log('Đã tải dữ liệu nhưng không nhận được sự kiện, điền dữ liệu vào dropdowns');
                        populateDropdowns();
                    }
                }, 5000);
                
            } catch (error) {
                console.error('Error during initialization:', error);
            }
        });
        
        // Đảm bảo updateConfigTableImages có thể truy cập toàn cục
        window.formatPrice = formatPrice;
    </script>

    <!-- Thêm script kết nối các component -->
    <script src="component-connector.js"></script>

    <!-- Event handlers script -->
    <script src="event-handlers.js"></script>

    <!-- Modern UI enhancements -->
    <script src="modern-ui.js"></script>

    <script>
    // Fix layout styling when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        // Ensure proper styling for navigation items
        const navItems = document.querySelectorAll('.nav-item, .step-item');
        if (navItems.length > 0) {
            navItems.forEach(item => {
                item.classList.add('fixed-layout');
            });
        }
        
        // Fix CPU selection items
        const cpuOptions = document.querySelectorAll('#intel-option, #amd-option');
        if (cpuOptions.length > 0) {
            cpuOptions.forEach(option => {
                option.classList.add('cpu-option');
            });
        }
        
        // Fix game cards
        const gameCards = document.querySelectorAll('.game-card');
        if (gameCards.length > 0) {
            gameCards.forEach(card => {
                card.classList.add('fixed-game-card');
            });
        }
        
        // Add wrapper for contact buttons if needed
        const contactButtons = document.querySelectorAll('a[href*="zalo"], a[href*="tel:"], a[href*="facebook"]');
        if (contactButtons.length > 0 && !document.querySelector('.contact-buttons')) {
            const firstButton = contactButtons[0];
            const parent = firstButton.parentNode;
            
            if (!parent.classList.contains('contact-buttons')) {
                const wrapper = document.createElement('div');
                wrapper.className = 'contact-buttons';
                
                contactButtons.forEach(button => {
                    wrapper.appendChild(button.cloneNode(true));
                });
                
                // Replace buttons with the wrapped version
                contactButtons.forEach(button => button.remove());
                parent.appendChild(wrapper);
            }
        }
        
        // Apply section styling to major containers
        const sections = document.querySelectorAll('.selection-section, .component-section, .budget-section');
        sections.forEach(section => {
            if (!section.classList.contains('styled-section')) {
                section.classList.add('styled-section');
            }
        });
        
        // Fix the header background
        const header = document.querySelector('header');
        if (header) {
            header.style.background = 'linear-gradient(135deg, #0053b4, #0275d8)';
        }
        
        // Add dark mode toggle if not present
        if (!document.querySelector('.dark-mode-toggle')) {
            const header = document.querySelector('header');
            if (header) {
                const toggle = document.createElement('div');
                toggle.className = 'dark-mode-toggle';
                toggle.innerHTML = '<i class="fas fa-moon"></i>';
                toggle.addEventListener('click', function() {
                    document.body.classList.toggle('dark-mode');
                    this.innerHTML = document.body.classList.contains('dark-mode') 
                        ? '<i class="fas fa-sun"></i>' 
                        : '<i class="fas fa-moon"></i>';
                });
                header.appendChild(toggle);
            }
        }
    });
    </script>
</body>

</html>
